---
title: "Data Science for Biologists, Fall 2020"
author: "Stephanie J. Spielman"
output: 
  learnr::tutorial:
    theme: united
    css: css/custom-css.css
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, collapse=TRUE)
library(learnr)
library(tidyverse) 
tutorial_options(exercise.lines = 10)

sparrows <- tibble::tribble(
  ~Sex,~Age,~Survival,~Length,~Wingspread,~Weight,~Skull_Length,~Humerus_Length,~Femur_Length,~Tarsus_Length,~Sternum_Length,~Skull_Width,
"Male","Adult","Alive",154,241,24.5,31.2,17.4,17,26,21.1,14.9,
"Male","Adult","Alive",160,252,26.9,30.8,18.7,18,30,21.4,15.3,
"Male","Adult","Alive",155,243,26.9,30.6,18.6,17.9,29.2,21.5,15.3,
"Male","Adult","Alive",154,245,24.3,31.7,18.8,17.5,29.1,21.3,14.8,
"Male","Adult","Alive",156,247,24.1,31.5,18.2,17.9,28.7,20.9,14.6,
"Male","Adult","Alive",161,253,26.5,31.8,19.8,18.9,29.1,22.7,15.4,
"Male","Adult","Alive",157,251,24.6,31.1,18.8,18.7,29.3,21.9,15.5,
"Male","Adult","Alive",159,247,24.2,31.4,18.5,18.2,28.6,20.1,15.5,
"Male","Adult","Alive",158,247,23.6,29.8,17.9,17.1,27.4,20.8,15.3,
"Male","Adult","Alive",158,252,26.2,32,19,18.8,29.3,21.8,15.6,
"Male","Adult","Alive",160,252,26.2,32,18.8,18.4,28.7,22.7,15.8,
"Male","Adult","Alive",162,253,24.8,32.3,19.5,19.1,28.8,23.4,16.1,
"Male","Adult","Alive",161,243,25.4,31.8,18.3,18.3,28.6,22.6,15.2,
"Male","Adult","Alive",160,250,23.7,29.8,18.5,17.9,28,20.8,15,
"Male","Adult","Alive",159,247,25.7,31.4,18.5,18.2,29,23.5,15,
"Male","Adult","Alive",158,253,25.7,31.9,18.9,17.8,29.2,21.8,15.2,
"Male","Adult","Alive",159,247,26.5,31.6,18.6,18.1,29.3,23.4,15.5,
"Male","Adult","Alive",166,253,26.7,32.5,19.5,19.4,31.2,22.3,15.2,
"Male","Adult","Alive",159,247,23.9,31.4,19.1,18.4,28.3,21,15.3,
"Male","Adult","Alive",160,248,24.7,31.3,19.1,18.7,29.9,20.4,15.3,
"Male","Adult","Alive",161,252,28,31.8,19.6,18.6,30.2,22.5,15,
"Male","Adult","Alive",163,251,27.9,31.9,19.5,18.9,29.7,21.8,15.8,
"Male","Adult","Alive",156,242,25.9,32,18.4,18.1,28.3,22.5,15.5,
"Male","Adult","Alive",165,251,25.7,32.2,19.1,18.8,29.5,22,15.6,
"Male","Adult","Alive",160,247,26.6,32.4,18.5,18,28.1,21.2,15,
"Male","Adult","Alive",158,244,23.2,31.6,18.5,18.1,29,22.6,14.9,
"Male","Adult","Alive",160,242,25.7,31.6,18,17.9,28.5,20,15.7,
"Male","Adult","Alive",157,245,26.3,32.2,18.8,18.4,29,21.6,15.1,
"Male","Adult","Alive",159,244,24.3,31.5,18.4,17.7,28.1,21.5,15.6,
"Male","Adult","Alive",160,253,26.7,32.1,18.8,18.1,28.4,21.9,15,
"Male","Adult","Alive",158,245,24.9,31.4,18.4,17.9,28.4,21.7,14.7,
"Male","Adult","Alive",161,247,23.8,31.4,18.7,17.6,28,20,15.3,
"Male","Adult","Alive",160,247,24.6,32.3,19.2,18.9,28.8,23,15.4,
"Male","Adult","Alive",160,247,27,32,19.2,18.7,29.8,22.2,16,
"Male","Adult","Alive",153,241,24.7,32.2,18.5,17.3,27.7,22.5,15,
"Male","Adult","Dead",165,249,26.5,31,18.8,17.9,27.8,21.5,15.4,
"Male","Adult","Dead",160,245,26.1,32,18.7,18,28.2,21.4,15.5,
"Male","Adult","Dead",161,249,25.6,32.3,18.9,18.2,28.7,21,15.3,
"Male","Adult","Dead",162,246,25.9,32.3,18.8,18,28.8,22.1,15.4,
"Male","Adult","Dead",163,250,25.5,32.5,19.1,18.6,30.4,22.6,15.8,
"Male","Adult","Dead",162,247,27.6,31.8,18.6,18.3,28.3,22.1,15.2,
"Male","Adult","Dead",163,246,25.8,31.4,17.5,16.8,27.3,21.2,15.3,
"Male","Adult","Dead",161,246,24.9,30.5,18.8,18.4,28.9,20.4,14.7,
"Male","Adult","Dead",160,242,26,31,18.9,18.1,28.1,20.4,15.2,
"Male","Adult","Dead",162,246,26.5,31.5,18.3,17.7,27.7,20.5,15.4,
"Male","Adult","Dead",160,249,26,31.4,18.4,17.5,27.9,21.6,15.3,
"Male","Adult","Dead",161,250,27.1,31.6,18.7,18.1,28.4,21.6,16,
"Male","Adult","Dead",162,248,25.1,31.9,18.9,18.3,29.3,21.3,15,
"Male","Adult","Dead",165,252,26,32.3,18.4,18,29.1,22.5,15.5,
"Male","Adult","Dead",161,243,25.6,32.5,18,18,28.5,21.1,15.4,
"Male","Adult","Dead",161,244,25,31.3,17.8,17.4,27.5,22.2,15.1,
"Male","Adult","Dead",162,248,24.6,31,18.1,17.8,27.6,21.3,15,
"Male","Adult","Dead",164,244,25,31.2,17.9,17.5,27.3,20.2,15.4,
"Male","Adult","Dead",158,247,26,32,18.5,18,29.1,20.4,15.4,
"Male","Adult","Dead",162,253,28.3,31.8,19.1,18.2,29.3,21.8,15.2,
"Male","Adult","Dead",156,239,24.6,30.5,16.7,16.7,26.5,20.6,14.5,
"Male","Adult","Dead",166,251,27.5,31.5,18.3,17.6,28.4,21.5,15.5,
"Male","Adult","Dead",165,253,31,32.4,19.4,19,30,23,15.6,
"Male","Adult","Dead",166,250,28.3,32.4,19.1,18.2,29.9,23.3,15.4,
"Male","Young","Alive",156,246,24.6,32,18.8,18.7,29.6,21.6,15,
"Male","Young","Alive",156,245,25.5,32.1,19.3,18.2,29.1,20.7,15.7,
"Male","Young","Alive",163,248,24.8,32.2,18.9,18.6,29.6,21.7,15.4,
"Male","Young","Alive",163,248,26.3,33,18.7,17.9,29.2,21.3,15.5,
"Male","Young","Alive",160,250,24.4,31.5,18.9,18.2,29.8,22.7,15.3,
"Male","Young","Alive",156,237,23.3,30.6,17.6,16.9,25.7,19.7,14.9,
"Male","Young","Alive",162,253,26.7,32,19.3,18.6,30.4,22.3,16,
"Male","Young","Alive",163,254,26.4,32,19.5,19,29.6,22.5,15.4,
"Male","Young","Alive",164,251,26.9,32,19.2,18.8,29.7,22.5,15.7,
"Male","Young","Alive",163,244,24.3,31.3,18.2,17.3,27.5,22.7,15.5,
"Male","Young","Alive",160,247,27,31.5,19.4,18.6,29.9,21.5,15.7,
"Male","Young","Alive",160,250,26.8,32.5,19.4,18.5,28.5,21.4,16.1,
"Male","Young","Alive",158,247,24.9,32.4,18.9,18.4,28.9,22,14.9,
"Male","Young","Alive",158,249,26.1,32.2,18.9,18.7,29.2,20.8,15.3,
"Male","Young","Alive",158,243,26.6,32.4,19,18.1,29.5,22.6,15.5,
"Male","Young","Alive",155,237,23.3,30.2,17.4,16.6,25.7,20.2,14.9,
"Male","Young","Dead",160,249,24.2,30.4,18.8,18.2,28.7,21.3,15.7,
"Male","Young","Dead",156,236,26.8,30,17.5,17,27.1,21.1,14.3,
"Male","Young","Dead",158,240,23.5,31,18.2,17.8,28.3,20.4,15.1,
"Male","Young","Dead",166,245,26.9,31.7,18.2,17.7,28.1,21.5,15.3,
"Male","Young","Dead",165,255,28.6,31.5,19.5,18.9,29.8,21.7,15.6,
"Male","Young","Dead",157,238,24.7,31.2,17.3,17.2,29.4,19.5,15.2,
"Male","Young","Dead",164,250,27.3,31.8,19.4,18.4,29.7,21.8,14.9,
"Male","Young","Dead",166,256,25.7,31.7,19.1,19.1,30.1,21.8,15.1,
"Male","Young","Dead",167,255,29,32.2,19.4,18.9,30.4,21.7,16.2,
"Male","Young","Dead",161,246,25,31.5,18.8,18,28.5,21.6,14.9,
"Male","Young","Dead",166,254,27.5,31.4,19.3,18.8,28.5,23.2,15.3,
"Male","Young","Dead",161,251,26,31.5,18.6,18,28.5,21,15,
"Female","Adult","Alive",156,245,25.3,31.6,18.5,18,29.3,20.5,15.7,
"Female","Young","Alive",154,240,22.6,30.4,17.9,17.4,28,19.6,14.8,
"Female","Adult","Alive",153,240,25.1,31,18.4,18.1,28.5,20.6,14.9,
"Female","Young","Alive",153,236,23.2,30.9,17.7,17.2,28.8,20.2,15.1,
"Female","Young","Alive",155,243,24.4,31.5,18.6,18.7,29.7,20.3,15.1,
"Female","Young","Alive",163,247,25.1,32,19,18.6,29.6,20.9,15.3,
"Female","Adult","Alive",157,238,24.6,30.9,18.4,18.5,29.8,20.2,14.9,
"Female","Adult","Alive",155,239,24,32.8,18.6,18.8,29.8,21.2,15.3,
"Female","Adult","Alive",164,248,24.2,32.7,19.1,19.1,30.5,21.1,15.3,
"Female","Young","Alive",158,238,24.9,31,18.8,17.5,27.7,22,15,
"Female","Adult","Alive",158,240,24.1,31.3,18.6,17.9,28.1,22,15,
"Female","Young","Alive",160,244,24,31.1,18.6,18.5,29.3,20.5,15,
"Female","Adult","Alive",161,246,26,32.3,19.2,18.6,29.3,21.8,15.8,
"Female","Adult","Alive",157,245,24.9,32,19.1,18.8,30.1,20,15.1,
"Female","Young","Alive",157,235,25.5,31.5,18.1,17.9,28.8,19.8,15.5,
"Female","Adult","Alive",156,237,23.4,30.9,18,17.6,28.5,20.3,15.6,
"Female","Adult","Alive",158,244,25.9,31.4,18.5,17.9,29.1,21.6,15.2,
"Female","Adult","Alive",153,238,24.2,30.5,18.2,18,28.3,20.9,15.1,
"Female","Adult","Alive",155,236,24.2,30.3,18.5,17.9,28.4,20.1,14.9,
"Female","Adult","Alive",163,246,27.4,32.5,18.6,18.1,29.5,21.9,16,
"Female","Adult","Alive",159,236,24,31.5,18,18.1,28.7,21.5,15.4,
"Female","Adult","Dead",155,240,26.3,31.4,18,18,28.5,20.7,15.6,
"Female","Adult","Dead",156,240,25.8,31.5,18.2,17.2,28.6,20.6,15.2,
"Female","Adult","Dead",160,242,26,32.6,18.8,18.6,29.4,21.7,15.2,
"Female","Young","Dead",152,232,23.2,30.3,17.2,17.3,26.6,19.8,15,
"Female","Adult","Dead",160,250,26.5,31.7,18.8,18.6,30.1,22.5,15.6,
"Female","Young","Dead",155,237,24.2,31,18.5,18.4,28.4,20,15.5,
"Female","Young","Dead",157,245,26.9,32.2,19.5,19.1,31.2,21.4,15.7,
"Female","Young","Dead",165,245,27.7,33.1,19.8,19.2,30.4,22,16.1,
"Female","Young","Dead",153,231,23.9,30.1,17.3,16.8,26.5,19.8,15,
"Female","Young","Dead",162,239,26.1,30.3,18,17.4,27.7,23.1,14.9,
"Female","Young","Dead",162,243,24.6,31.6,18.8,18.5,29.5,21.3,15.4,
"Female","Young","Dead",159,245,23.6,31.8,18.5,17.8,28.7,21.7,15.5,
"Female","Young","Dead",159,247,26,30.9,18.1,16.9,27.9,19,14.7,
"Female","Adult","Dead",155,243,25,30.9,18.5,18.1,28.6,21.3,15.2,
"Female","Adult","Dead",162,252,24.8,31.9,19.1,18.7,30,22.2,15.6,
"Female","Adult","Dead",152,230,22.8,30.4,17.3,16.9,26.5,18.6,14,
"Female","Adult","Dead",159,242,24.8,30.8,18.2,16.9,27.7,20.5,14.6,
"Female","Adult","Dead",155,238,24.6,31.2,17.9,17.8,28,19.3,14.9,
"Female","Young","Dead",163,249,30.5,33.4,19.5,19.5,30.7,22.8,16.3,
"Female","Young","Dead",163,242,24.8,31,18.1,18.1,28.7,20.7,15.4,
"Female","Adult","Dead",156,237,23.9,31.7,18.2,18.2,27.7,20.3,15.5,
"Female","Adult","Dead",159,238,24.7,31.5,18.4,17.8,29.1,20.3,15.2,
"Female","Young","Dead",161,245,26.9,32.1,19.1,17.9,29,20.8,15.4,
"Female","Adult","Dead",155,235,22.6,30.7,17.6,17.6,28.4,19.6,14.8,
"Female","Adult","Dead",162,247,26.1,31.9,19.1,18.7,29.4,20.4,15.7,
"Female","Young","Dead",153,237,24.8,30.6,18.6,18.2,29.8,20.4,15.1,
"Female","Young","Dead",162,245,26.2,32.5,18.5,18.6,28,21.1,15.6,
"Female","Young","Dead",164,248,26.1,32.3,18.8,18,29.4,20.9,15
) %>%
  dplyr::mutate(Age = as.factor(Age), 
                Survival = as.factor(Survival), 
                Sex = as.factor(Sex))

sparrows %>%
  dplyr::group_by(Sex) %>%
  dplyr::summarize(mean_wingspread = mean(Wingspread)) -> sparrow_summarized

```

# Introduction to making figures with `ggplot2`
<br>

## References

For help, your go-to references are:

1. [The official ggplot2 documentation](https://ggplot2.tidyverse.org/reference/) provides information for using `ggplot2` functions and commands
2. [The ggplot2 CheatSheet](https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf) is an _information rich_ overview of much of `ggplot2`'s functionality
3. [Chapter Five from "Fundamentals of Data Visualization"](https://serialmentor.com/dataviz/directory-of-visualizations.html) provides a "directory" of different types of plots which exist for different types of data
4. [Chapter Three from "Data Visualization: A practical introduction"](https://socviz.co/makeplot.html) introduces `ggplot2` usage
5. [Chapter Three from "R for Data Science"](https://r4ds.had.co.nz/data-visualisation.html) introduces `ggplot2` usage
6. [All the R colors you ever wanted to use!!](https://github.com/sjspielman/datascience_for_biologists/raw/master/spring2020/rmd_lessons/static/Rcolor.pdf)

## Background: The `ggplot2` package

This lab focuses on making figures using the `ggplot2` package, which is one of several [`tidyverse`](https://tidyverse.tidyverse.org/) packages. To obtain `ggplot2`, you will need to first _install_ the library, and then _load_ the library for use in your current R session. **The library has already been installed for you**, but IF you were to install it, here's what you would do!

The command to install packages is `install.packages()` - you must provide package names _in quotes!_ to this function:
```{r, eval=FALSE}
install.packages("ggplot2")
```
You may see red text going down the console - don't worry! These are just messages indicating the stage of installation; they are not errors. **You only need to run package installation ONCE within a given RStudio Cloud space (or, once on your computer)**. Once it has been installed, you can use the package by loading it when needed.


Once this package installation completes, you can load packages for use with the `library()` function (quotes or no quotes, doesn't matter here):
```{r, eval=FALSE}
library(ggplot2)
# or, library("ggplot2), or library('ggplot2')
```

**AGAIN, THIS HAS BEEN DONE FOR YOU IN THESE INTERACTIVE EXERCISES! YOU DON'T NEED TO RUN THIS CODE!!**


## Background: The data

All exercises here will use a pre-loaded dataset called `sparrows`. This dataset was collected in 1898 by Hermon Bumpus, an American biologist working at Brown University (fun fact: Dr. Spielman's *alma mater*!). Immediately following a bad winter storm, he collected 136 English house sparrows (some alive, some dead), *Passer domesticus*, and brought them indoors. Of these birds, 64 had died during the storm, but 72 recovered and survived. Bumpus measured the birds' physical traits (in mm or g) and recorded them for future generations of data science students.

**Before you begin the exercises, examine the dataset here!!**

```{r examine-sparrows, exercise=TRUE}
sparrows
```


## Set 1: Scatterplots 

Scatterplots show the **relationship** between two variables, and they use the `geom_point()` geometry as shown in this example where sparrow Weight is plotted *across* sparrow Wingspread (y goes across x!).

```{r scatter_demo, exercise = TRUE}
ggplot(sparrows) + # Use the sparrows dataset
  aes(x = Wingspread, y = Weight) +  # Specify columns Wingspread and Weight to go on x and y axis. 
  geom_point() # Use points
```

The `geom_point()` geom can accept several visual features, which can either be plainly specified to `geom_point()` or specified as an *aesthetic* if they map to the data. The most important ones are:

+ `color`: Color of points
  + *Certain* types of points can also have a `fill` (question 9 below)
+ `size`: Size of points
+ `shape`: Shape of points
+ For more, check out the [`geom_point()` documentation](https://ggplot2.tidyverse.org/reference/geom_point.html) and scroll to "Aesthetics", and then *keep scrolling for Examples!*. **HINT: the documentation is GOOD to read!!!!!!!!!!!!!! I read it all the time, still!** One great way to get more practice is to follow and re-create examples from documentation!
<!-- vignette("ggplot2-specs") -->


1. Make a scatterplot of femur length across wingspread. Remember: This terminology means *Y across X*.

> Hint: You may want to use the function `head()` or `names()` (try it out!!) to remind yourself what the relevant column names from the `sparrows` dataset are!!

```{r scatter_1, exercise = TRUE}

```

```{r scatter_1-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point() 
```

2. Again make a scatterplot of femur length across wingspread, but make all points the color red.

> Hint: This is simply coloring points, not mapping color to a variable. Just add the color argument to `geom_point()`. Colors MUST go in QUOTES - `"red"` (or `'red'`), NOT `red`.

```{r scatter_2, exercise = TRUE}

```

```{r scatter_2-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point(color = "red") 
```

3. Again make a scatterplot of femur length across wingspread, but this time color all points _based on survival status_. 

> Hint: This IS mapping a variable to a color, so you need to place your color argument inside aes(). 


```{r scatter_3, exercise = TRUE}

```

```{r scatter_3-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Survival) +  
  geom_point() 
```


#### **Sidenote!** An *extremely common* bug/typo you can now look forward to doing for the rest of your life is accidentally placing a column *outside* of `aes()`. Here's an example of that bug.

> `ggplot2` can only automatically know that you are referring to a column if it's inside `aes()`. If it's outside an `aes()`, R wants to find a variable with that name. But, `Survival` is not a variable on its own - it only exists as a column within `sparrows`.

```{r scatter_sidenote, exercise=TRUE}
# This code won't work! Run it to see and UNDERSTAND the error message. Then, ccan you fix it?
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point(color=Survival) 
```

```{r scatter_sidenote-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Survival) +  
  geom_point() 
```


4. Again make a scatterplot of femur length across wingspread, but this time color all points based on _weight_. Unlike survival, weight is a *numeric continuous* variable so you'll get a gradient of colors rather than a color for each survival category.
```{r scatter_4, exercise = TRUE}

```

```{r scatter_4-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Weight) +  
  geom_point() 
```


5. Again make a scatterplot of femur length across wingspread, with points colored based on _weight_. But this time, let's add some more professional labels to the plot using the `labs()` function, which you can see in action [here](https://ggplot2.tidyverse.org/reference/labs.html). The code below changes the X-axis label as shown - run and understand the code, and then add in the following y-axis label and title:

+ Y axis: "Femur Length (mm)"
+ Title: "Scatterplot of sparrow wingspread and femur length"
+ For some extra bells and whistles, try adding a caption or subtitle!!

> Hint: You actually need to visit that link to see what *arguments* you need to use in `labs()` to specify these labels. **Looking at the documentation is AMAZING!!**

```{r scatter_5, exercise = TRUE}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Weight) +  
  geom_point() +
  labs(x = "Wingspread (mm)")
```

```{r scatter_5-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Weight) +  
  geom_point() +
  labs(x = "Wingspread (mm)",
       y = "Femur Length (mm)",
       title = "Scatterplot of sparrow wingspread and femur length")
```

6. The code below makes a scatterplot of femur length across wingspread with points colored by _Age_. You'll notice in the legend that "Young" comes before "Adult" - this is because R interprets the order alphabetically by default! To change the order, we need to change the **levels** of the factor variable `Age`. Follow the comments and the code below to change the order of `Age` and remake the plot.

```{r scatter_6, exercise = TRUE, exercise.lines = 15}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Age) +  
  geom_point()

# See the default order of a factor with the levels() function
levels(sparrows$Age)

# RE-DEFINE the order like this. Run this code to see:
# This *permanently* changes the Age column in sparrows, unless you change it again later
sparrows$Age <- as.factor(sparrows$Age, levels=c("Young", "Adult"))
levels(sparrows$Age)

# Now you can re-make the plot using the re-defined sparrows data frame
# Aka, literally re-run the plotting code at the top of this exercise chunk
```



7. The code below makes a scatterplot of femur length across wingspread with points colored by _Sex_. Using the same approach as in the previous question, make "Male" come BEFORE "Female" in the plot.

```{r scatter_7, exercise = TRUE}

```

```{r scatter_7-solution}
# See the default order of a factor with the levels() function
# Always always look at the data before changing ANY definitions!!!
levels(sparrows$Sex)

# RE-DEFINE the order like this. Run this code to see:
# This *permanently* changes the Age column in sparrows, unless you change it again later
sparrows$Sex <- as.factor(sparrows$Age, levels=c("Female", "Male"))

# Confirm that the re-level worked:
levels(sparrows$Sex)

# And plot:
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Sex) +  
  geom_point()
```

8. Finally, let's play with point size and shape. [This website](https://www.google.com/url?sa=i&url=http%3A%2F%2Fwww.sthda.com%2Fenglish%2Fwiki%2Fr-plot-pch-symbols-the-different-point-shapes-available-in-r&psig=AOvVaw0OJUM40mKjvj8_grWKRxXT&ust=1600267681741000&source=images&cd=vfe&ved=0CAIQjRxqFwoTCODXw-ez6-sCFQAAAAAdAAAAABAD) shows all the different shapes in R you can use - we specify them with numbers. (Note: this website shows some example plotting using a non-`ggplot2` approach. Ignore that. We only care about the point symbols!) The plot below contains larger points at size 2, and points shaped like triangles. First run and understand the template code. Then, modify the code to make the points size 3 and with a new point style of your choosing!!

> Hint: We are literally providing a single size and shape, NOT mapping size and shape to the data! Therefore, they are regular arguments to `geom_point()`, NOT to `aes()`.

```{r scatter_8, exercise = TRUE}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point(size = 2, shape = 17)
```

```{r scatter_8-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point(size = 3, shape = 18)
```

9. Shapes 21-25 are actually a little different from other shapes - they can be colored *and filled*. Here, color means *outline* and fill means *fill*. Re-make the scatterplot but specify shape = 21, and specify a color and fill of your choosing to `geom_point()` to see this in action.

> Hint: Don't forget the magical PDF of all the [R colors](https://github.com/sjspielman/datascience_for_biologists/raw/master/spring2020/rmd_lessons/static/Rcolor.pdf) ! Have some fun :)

```{r scatter_9, exercise = TRUE}

```


```{r scatter_9-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point(shape = 21, color = "navy", fill ="cadetblue")
```


10. We can actually *save* plots as variables and re-use them! Because `ggplot2` is designed to keep adding plot components on top of one another, we can even add plot components on top of a plot. The code below creates our new favorite (least favorite by now?) scatterplot. Try it out!

> Hint: The assignment operator can be used in either direction, as long as it points to the *variable name*. `x <- 7` and `7 -> x` are both good!! `x -> 7` is not :(

```{r scatter_10, exercise=TRUE, exercise.lines = 20}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point() -> sparrow_wing_femur_plot # Use the assignment operator in the forward direction for better flow of code!

# Examine the plot first
sparrow_wing_femur_plot

# Next, UNCOMMENT the next code and run it to see some awesome. IMPORTANT: this does NOT change the definition of `sparrow_wing_femur_plot`
#sparrow_wing_femur_plot +
#  labs(x = "OMG WE ADDED AN X-AXIS LABEL!")

# Finally, add both x and y axis labels to the plot below in the space below:

```

```{r scatter_10-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point() -> sparrow_wing_femur_plot

sparrow_wing_femur_plot + 
  labs(x = "Wingspread (mm)", 
       y = "Femur length (mm)")
```


11. So far, we have been writing separate lines for the `aes()`. In fact, you can include `aes()` in the initial call to `ggplot()` or to any `geom_` function to specify aesthetics for that geom (as we'll learn soon, you can have multiple geoms in a plot!). The code below demonstrates this concept; Run the code below to understand that you can place `aes()` in many locations.

> It is VERY common (in fact it's the norm!!) for people to include `aes()` inside the initial call to `ggplot()`.

```{r scatter_11, exercise=TRUE}
# Place aes in ggplot(). This is EQUIVALENT to aes() on their own line
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +  
  geom_point() 

# Place aes in geom_point(). We'll see soon - this does slightly different things!
ggplot(sparrows) +  
  geom_point(aes(x = Wingspread, y = Femur_Length))
```


12. Now, let's add another geom! The function `geom_smooth()` can be used to add a trendline to the plot, using one of several modeling options. To get a line of best fit (aka regression line), use the code `geom_smooth(method = "lm")`. Re-create your scatterplot (no colors or aesthetics besides x and y) but add (literally, add!) this geom to your plot to show the trendline for your data.

> By default, `geom_smooth()` will include a 95% confidence interval, showing the statistical bands for where the true trendline is. You can include the argument `se=FALSE` to `geom_smooth()` to disable the bands - try it out! (`se` stands for "standard error," which is mathematically very closely related to the confidence interal).

> You will note that `ggplot2` returns the message: "`geom_smooth()` using formula 'y ~ x'". This is NORMAL and EXPECTED: It is telling you what type of trendline was calculated. You can safely IGNORE IT.

> For an added challenge, include see what adding `color` and `fill` arguments to geom_smooth does! Use these arguments in the same way you'd provide "just a color/fill" to `geom_point()`.


```{r scatter_12, exercise=TRUE}


```


```{r scatter_12-solution}
# With confidence bands
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm")

# Without confidence bands
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE)


################### Added challenge ########################
# With confidence bands and color
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", color = "orange")

# With confidence bands and color and fill!
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", color = "orange", fill = "navy")
```


13. Let's combine insights from tasks 11-12 here: `aes()` placement when using multiple geoms. This time, we'd like to specify a color aesthetic for `Survival`. Re-build your plot with `geom_point()` and `geom_smooth()` with this aesthetic using three different placements for *the COLOR aes*. For all plots, place the `x` and `y` aesthetics in the initial `ggplot()` call.

+ Place the color aesthetic in the initial `ggplot()` call, *along with* `x` and `y`
+ Place the color aesthetic in `geom_point()` call *only*
+ Place the color aesthetic in `geom_smooth()` call *only*
+ Place the color aesthetic in `geom_smooth()` call *only*, but ALSO ADD a "regular" color argument to `geom_smooth()`
  + This example is meant to show you how `ggplot2` might resolve *conflicting instructions* (color as aes and as "just a color" - what will it do?!)

> For an added challenge, experiment with the `fill` aesthetic placement as well. This aesthetic is ONLY used by `geom_smooth()`, not `geom_point()` (since regular points don't have a fill). This is an opportunity to learn through engagement!
  
> Hint: Don't forget to actually put `color = Survival` inside of the `aes()` function, no matter its placement!!!!

```{r scatter_13, exercise=TRUE}

```


```{r scatter_13-solution}
# color aes in initial ggplot call
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length, color = Survival)) +
  geom_point() + 
  geom_smooth(method = "lm")

# color aes in geom_point() call
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm")

# color aes in geom_smooth() call
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", aes(color = Survival))

# color aes in geom_smooth() call AND a color is added, to see what happens!
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", aes(color = Survival), color = "purple")

# Like the last example, but what if I switched the arguments around?
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", color = "purple", aes(color = Survival))


################### Added challenge ########################
### What about fill placement? Can you see how and why these produce different plots?
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length, fill = Survival, color = Survival)) +
  geom_point() + 
  geom_smooth(method = "lm")

ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point(aes(fill = Survival, color = Survival)) + 
  geom_smooth(method = "lm")

ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", aes(fill = Survival, color = Survival))

ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point(aes(color = Survival)) + 
  geom_smooth(method = "lm", aes(fill = Survival))
```







14. Make one more version of this figure that contains the following features:

+ Clean and professional labels using `labs()`
+ *Color* all points based on `Survival`
  + With an included *trendline* for EACH `Survival` level (make sure your aesthetic placement is appropriate!)
+ *Size* all points based on `Weight` (Hint: use `size` as an aesthetic to map the given variable)
+ Make all the points into shape 15
+ **BONUS**: Try changing the [theme](https://ggplot2.tidyverse.org/reference/ggtheme.html)

Once the plot is made, think about these design choices. Just because one *can* add these visual features, does it mean one *should* add these visual features? (Answer: No.)

> Note: Some of the legend colors will come out funky - later, we will learn how to deal with this type of situation.

```{r scatter_14, exercise = TRUE}

```


```{r scatter_14-solution}
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length, color = Survival, size = Weight)) +  
  geom_point(shape = 15) + 
  geom_smooth(method = "lm") +
    labs(x = "Wingspread (mm)",
         y = "Femur Length (mm)",
         title = "Scatterplot of sparrow femur length across wingspread ",
         subtitle = "Oh wow is this an ugly plot!")
```



## Set 2: Visualizing distributions

There are *many* different plotting strategies for visualizing distributions, specifically, *values of a numeric variable.* Some more popular options and their geoms (which link to the documentation!) include...

Plot | Geom (yes, these are links!) | Notes
:----|:-------|:-------
Histogram    | [`geom_histogram()`](https://ggplot2.tidyverse.org/reference/geom_histogram.html) | Only ONE axis is specified in `aes()` (usually the x-axis). `ggplot2` takes care of the other axis for you - it *counts and bins on your behalf!* (A close relative is *frequency polygons*)
Density plot | [`geom_density()`](https://ggplot2.tidyverse.org/reference/geom_density.html) | Think of this as a smoothened histogram. Same as for histogram, you only specify the X axis.
Boxplot      | [`geom_boxplot()`](https://ggplot2.tidyverse.org/reference/geom_boxplot.html) | Best used when making multiple boxplots in a single panel
Strip Plot   | [`geom_jitter()`](https://ggplot2.tidyverse.org/reference/geom_jitter.html)  | Or, `geom_point(position = position_jitter())`!
Violin Plot  | [`geom_violin()`](https://ggplot2.tidyverse.org/reference/geom_violin.html) | The hybrid child of a density plot and a boxplot, kind of!
Sina Plot    | [`geom_sina()`](https://ggforce.data-imaginist.com/reference/geom_sina.html)    | The hybrid child of a density plot and a strip plot. *Requires a separate package called `ggforce` to plot.*


Our goal here is to visualize the distribution of `Wingspread` to learn how to use each type of plot.
<br><br>

1. Make a simple histogram of sparrow Wingspread using `geom_histogram()`. Remember: You only should specify the X-axis; `ggplot2` will do the Y-axis for you!

> For an added insight, try specifying `Wingspread` as the `y` *instead of* as the `x` aesthetic. `ggplot2` will then make a horizontal histogram!


```{r dist_1, exercise = TRUE}

```

```{r dist_1-solution}
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram()
```

2. You will notice that `ggplot2` returns a *warning message* when you make histograms: "`stat_bin()` using `bins = 30`. Pick better value with `binwidth`." This is an EXPECTED AND NORMAL message. It is `ggplot` telling you: I assumed there should be *30 bins* along your X-axis in your histogram. It suggests ONE way you can customize the binning: Using the argument `binwidth` to `geom_histogram()` to specify how wide along the X-axis a bin should be. Alternatively, can also use the argument `bins` to `geom_histogram()` to specify how many bins there should be (its default is 30! Get it?).

Re-create your histogram in five separate versions, each with a different specification to `binwidth`: 0.1, 1, 5, 10, and 20. *Think about* which version(s) represent(s) the data well, and which version(s) is/are just terrible ideas. 

> For an added challenge, also experiment with the `bins` argument instead of `binwidth`.

```{r dist_2, exercise = TRUE}

```

```{r dist_2-solution}
# binwidth of 0.1
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram(binwidth = 0.1)

# binwidth of 1
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram(binwidth = 1)

# binwidth of 5
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram(binwidth = 5)

# binwidth of 10
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram(binwidth = 10)

# binwidth of 20
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram(binwidth = 20)
```

3. This is really where variables start to become important: Let's say you have an R script which creates 50 histograms, and you want 15 bins for all histograms (i.e., `geom_histogram(bins = 15)`). One option is to make all plots and write `15` for the argument. This works well..until you change your mind later and decide that maybe 12 would have been better. Rather than having to find and replace all `15`'s, we could just have a variable used in the code, and simply change the variable and have it automatically apply. 

Run the code below to see this in action, and then *change* the `my_bins` variable to equal 5. Re-run the code with this new variable definition to see the change.

```{r dist_3, exercise = TRUE}
my_bins <- 15
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram(bins = my_bins)
```

```{r dist_3-solution}
my_bins <- 5
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram(bins = my_bins)
```

4. How about some colors? Add "just a fill" and "just a color" of your choosing to the plot. This will also help you to see the boundaries of your bins.

> Hint: Don't forget [my favorite PDF](https://github.com/sjspielman/datascience_for_biologists/raw/master/spring2020/rmd_lessons/static/Rcolor.pdf)!

+ Added challenge: Also add "just a size" (use a value below 3, trust me...) to your histogram to see what it does! 
+ For an double added challenge, make all your visual features variables to use in your plot rather than the direct values

```{r dist_4, exercise = TRUE}

```

```{r dist_4-solution}
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram(color = "chocolate3", fill = "skyblue")

# With size:
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram(color = "chocolate3", fill = "skyblue", size = 2)

# Using variables:
hist_color <- "chocolate3"
hist_fill <- "skyblue"
hist_line_size <- 2
ggplot(sparrows, aes(x = Wingspread)) +
  geom_histogram(color = hist_color, fill = hist_fill, size = hist_line_size)

```




5. Now let's make a *density plot* of `Wingspread` using `geom_density()`. Since the Y-axis of density plots are a transformed value, leave the `y` aesthetic blank just like for histograms. *Start off strong by adding "just a FILL" of your choosing to your density plot!!*

```{r dist_5, exercise = TRUE}

```

```{r dist_5-solution}
ggplot(sparrows, aes(x = Wingspread)) +
  geom_density(fill = "palegreen4")
```

6. To make add transparency to colors, we can use the `alpha` argument *given directly to the relevant geom*. Values of alpha range from 0-1, where 0 is fully transparent and 1 is fully opaque. Add some alpha to your plot to practice this argument.

> For an added challenge, make a variable to use for your `alpha` value!

```{r dist_6, exercise = TRUE}

```

```{r dist_6-solution}
ggplot(sparrows, aes(x = Wingspread)) +
  geom_density(fill = "palegreen4", alpha = 0.6)
```


7. To add transparency, we can use the `alpha` argument *given directly to the relevant geom*. Values of alpha range from 0-1, where 0 is fully transparent and 1 is fully opaque. Add some alpha to your plot to practice this argument.

> For an added challenge, make a variable to use for your `alpha` value!

```{r dist_7, exercise = TRUE}

```

```{r dist_7-solution}
ggplot(sparrows, aes(x = Wingspread)) +
  geom_density(fill = "palegreen4", alpha = 0.6)
```


8. Let's now look at *both* male and female distributions (`Sex`) in one plot - we need only add a fill aesthetic to accomplish this! Indeed, the X-axis is still `Wingspread`, Y is still automatically calculated, and the only distinction between male and female distributions would therefore the be their fill!

> Hint: alpha is a really, really good idea here.

```{r dist_8, exercise = TRUE}

```

```{r dist_8-solution}
ggplot(sparrows, aes(x = Wingspread, fill = Sex)) +
  geom_density(alpha = 0.6)
```

9. Moving on to *boxplots*: Let's make a boxplot of Wingspread for each Sex with `geom_boxplot()`.. Axes are not transformed values in boxplots, so we'll need to specify *First, DRAW (or conceptualize) BY HAND (yes, by hand), how you expect the plot to look.* Think about what variable is on each axis, and then build your plot up accordingly.

> Up your game right away! Can you add "just a fill" and/or "just a color"? Your plot, your choice!
> Instead of "just" a fill, can you fill distributions by `Sex`? Hint: You'll need to add another aesthetic mapping for `Sex` on top of what you already have?
> Next level: Instead of filling by `Sex`, fill by `Survival`. Understand what happened here and how the fill ended up in the plot. Getting cool, right? 

```{r dist_9, exercise = TRUE}

```

```{r dist_9-solution}
# Boxplot with "just" a fill
ggplot(sparrows, aes(x = Sex, y = Wingspread)) +
  geom_boxplot(fill = "slateblue3")

# Boxplot filled by Sex - don't forget to remove any straggling "just" fills!
ggplot(sparrows, aes(x = Sex, y = Wingspread, fill = Sex)) +
  geom_boxplot()

# Boxplot filled by Survival - make sure you see how the aes mappings lead to the created plot! Ask me questions!
ggplot(sparrows, aes(x = Sex, y = Wingspread, fill = Survival)) +
  geom_boxplot()
```


10. Re-make the boxplots above but as a *violin plot* using `geom_violin()`. Your code here will be virtually identical, except for the geom specification. 



```{r dist_10, exercise = TRUE}

```

```{r dist_10-solution}
# Violin with "just" a fill
ggplot(sparrows, aes(x = Sex, y = Wingspread)) +
  geom_violin(fill = "slateblue3")

# Violin filled by Sex 
ggplot(sparrows, aes(x = Sex, y = Wingspread, fill = Sex)) +
  geom_violin()

# Violin filled by Survival 
ggplot(sparrows, aes(x = Sex, y = Wingspread, fill = Survival)) +
  geom_violin()
```



11. Let's now practice Dr. Spielman's favorite plot: strip plots. Dr. Spielman loves these SO much because they actually show ALL of the data! Not summarized into bins or boxplot summaries, but literally all the points. Make a strip plot (using `geom_jitter()`) of `Wingspread` across `Sex`.

> You may need to change the _spacing_ of the points in the strip plot. You can do this with the argument `width` to `geom_jitter()`. I have personally found that 0.1-0.3 is usually a nice range for this argument.
> NOTE: `geom_jitter()` is actually just a special version of `geom_point()`, so all point aesthetics apply here.
> You may want to change the size of points to make everything cleanly visible. Perhaps the plot would also benefit from some transparency to the points?
> The "jittering" to the points is random, so every time you re-make the plot, the specific x-location of the points will change. Think: Why should the Y location NEVER change? (Answer: The Y axis is actual wingspread data!)

```{r dist_11, exercise = TRUE}

```

```{r dist_11-solution}

ggplot(sparrows, aes(x = Sex, y = Wingspread)) +
  geom_jitter()

# narrower width - compare this to the default above to understand how it works!
ggplot(sparrows, aes(x = Sex, y = Wingspread)) +
  geom_jitter(width = 0.1)

# want to change the size? practice learning how these arguments modify the plot!
ggplot(sparrows, aes(x = Sex, y = Wingspread)) +
  geom_jitter(width = 0.1, size = 3, alpha = 0.5)
```



12. Re-make the strip plot, but also color by `Survival` (inside `aes()`!). You'll find a result somewhat to the boxplot version of this plot.

> Think: Why did I say color and not fill, as I did for boxplot? Make sure you understand the difference!

> Make sure to check the width -  does it need to be tweaked for clear interpretation?

```{r dist_12, exercise = TRUE}

```

```{r dist_12-solution}
ggplot(sparrows, aes(x = Sex, y = Wingspread, color = Survival)) +
  geom_jitter(width = 0.1)

# Bonus information: this is actually just a shortcut for...
ggplot(sparrows, aes(x = Sex, y = Wingspread, color = Survival)) +
  geom_point(position = position_jitter(width = 0.1))
```

13. Re-make the strip plot, but add the argument `position = position_jitterdodge()` to `geom_jitter()` (again, check the width!). Compare this plot to the one you made in #11: Think, what have you learned about "dodged" positioning (the default observed in #11 is called "stacked" positioning)? 

> Dodging vs stacking can be customized when you are showing multiple distributions at the same tick along the X-axis. For example, here we have both dead and alive birds for EACH TICK male and female along the X-axis. The specific way to specify dodging is a little different for other geoms. Here, we just want to see the concept for how it works for strip plots.
>**NOTE:** If you specify this argument and want to customize width also, you must place the argument `jitter.width` INSIDE, e.g. position = position_jitterdodge(jitter.width = 0.1)


```{r dist_13, exercise = TRUE}

```

```{r dist_13-solution}
ggplot(sparrows, aes(x = Sex, y = Wingspread, color = Survival)) +
  geom_jitter(position = position_jitterdodge())

# This is actually the same as...
ggplot(sparrows, aes(x = Sex, y = Wingspread, color = Survival)) +
  geom_point(position = position_jitterdodge())
```

## Set 3: Visualizing Amounts/Counts

The most common approach visualizing amounts, or count, data is with barplots, which we will focus on in this set.


*Exercises forthcoming.*















